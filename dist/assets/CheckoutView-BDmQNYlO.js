import{m as N,L as j,h as k,d as P,o as i,c as r,a as t,F as $,r as F,t as l,s as d,v as y,g as c,f as g,B as R,l as U,A as S,G as b}from"./index-vxcYk4Au.js";import{S as q}from"./sweetalert2.esm.all-XY7ebsws.js";const E={class:"min-h-screen bg-earth-50"},K={class:"max-w-4xl mx-auto px-4 py-6 md:px-6 md:py-8"},L={class:"grid grid-cols-1 lg:grid-cols-3 gap-6 md:gap-8"},A={class:"lg:col-span-2"},I={class:"card p-4 md:p-6 mb-4 md:mb-6"},Z={class:"space-y-3 md:space-y-4"},z=["src","alt"],G={class:"flex-1 min-w-0"},H={class:"font-medium text-gray-900 text-sm md:text-base truncate"},J={class:"text-xs sm:text-sm text-gray-600"},Q={class:"text-xs sm:text-sm text-gray-600"},W={class:"text-right mt-2 sm:mt-0"},Y={class:"font-semibold text-gray-900 text-sm md:text-base"},ee={class:"card p-6 mb-6"},te={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},oe={key:0,class:"text-red-500 text-xs mt-1"},ae={key:0,class:"text-red-500 text-xs mt-1"},se={key:0,class:"text-red-500 text-xs mt-1"},le={key:0,class:"text-red-500 text-xs mt-1"},ne={key:0,class:"text-red-500 text-xs mt-1"},ie={class:"md:col-span-2"},re={key:0,class:"text-red-500 text-xs mt-1"},de={class:"card p-6"},ue={class:"space-y-3"},me={class:"flex items-center space-x-3 p-3 border rounded-lg cursor-pointer hover:bg-gray-50"},pe={class:"flex items-center space-x-3 p-3 border rounded-lg cursor-pointer hover:bg-gray-50"},ve={class:"flex items-center space-x-3 p-3 border rounded-lg cursor-pointer hover:bg-gray-50"},ce={class:"lg:col-span-1"},ge={class:"card p-6 sticky top-4"},xe={class:"space-y-3"},ye={class:"flex justify-between"},be={class:"font-medium"},fe={class:"flex justify-between"},ke={class:"font-medium"},he={class:"flex justify-between"},we={class:"font-medium"},Se={class:"border-t pt-3"},Ce={class:"flex justify-between"},Te={class:"text-xl font-bold text-green-600"},Oe=["disabled"],Xe={__name:"CheckoutView",setup(Be){const u=N(),T=j(),f=k(JSON.parse(localStorage.getItem("cart")||"[]")),a=k({name:"",email:"",phone:"",address:"",city:"",region:""}),s=k({name:"",email:"",phone:"",address:"",city:"",region:""}),O=/^[^\s@]+@[^\s@]+\.[^\s@]+$/,B=/^\+255\d{9}$|^0\d{9}$/,p=n=>{switch(s.value[n]="",n){case"name":a.value.name.trim()?a.value.name.trim().length<3&&(s.value.name="Name must be at least 3 characters"):s.value.name="Full name is required";break;case"email":a.value.email.trim()?O.test(a.value.email)||(s.value.email="Please enter a valid email address"):s.value.email="Email address is required";break;case"phone":a.value.phone.trim()?B.test(a.value.phone.replace(/\s/g,""))||(s.value.phone="Please enter a valid Tanzanian phone number (+255 XXX XXX XXX)"):s.value.phone="Phone number is required";break;case"address":a.value.address.trim()?a.value.address.trim().length<10&&(s.value.address="Please enter a complete delivery address"):s.value.address="Delivery address is required";break;case"city":a.value.city.trim()||(s.value.city="City/District is required");break;case"region":a.value.region||(s.value.region="Please select a region");break}},D=()=>{let n=!0;return Object.keys(a.value).forEach(e=>{p(e),s.value[e]&&(n=!1)}),n},m=k("mobile-money"),x=b(()=>f.value.reduce((n,e)=>n+e.price*e.quantity,0)),h=b(()=>x.value>1e4?0:2e3),w=b(()=>Math.round(x.value*.02)),C=b(()=>x.value+h.value+w.value),M=b(()=>a.value.name&&a.value.email&&a.value.phone&&a.value.address&&a.value.city&&a.value.region&&m.value&&Object.values(s.value).every(n=>!n)),X=()=>{if(!D()){const o=Object.keys(s.value).find(v=>s.value[v]);if(o){const v=document.querySelector(`[placeholder*="${o}"], [value="${a.value[o]}"]`);v&&(v.scrollIntoView({behavior:"smooth",block:"center"}),v.focus())}return}const n={items:f.value,delivery:a.value,payment:m.value,totals:{subtotal:x.value,delivery:h.value,service:w.value,total:C.value},type:"Purchase Order",statusHistory:[{status:"pending",timestamp:new Date().toISOString(),notes:"Order placed successfully"}]},e=T.createOrder(n);localStorage.removeItem("cart"),f.value=[],q.fire({title:"Order Placed Successfully! ðŸŽ‰",text:`Order #${e.id} has been placed and will be delivered to ${a.value.city}, ${a.value.region}`,icon:"success",draggable:!0,showConfirmButton:!0,confirmButtonText:"View My Orders",confirmButtonColor:"#10b981",showCancelButton:!0,cancelButtonText:"Continue Shopping",cancelButtonColor:"#6b7280",backdrop:"rgba(0,0,123,0.4)",allowOutsideClick:!1,allowEscapeKey:!1}).then(o=>{console.log("SweetAlert result:",o),console.log("result.isConfirmed:",o.isConfirmed),console.log("result.isDismissed:",o.isDismissed),o.isConfirmed?(console.log("Navigating to orders page..."),u.push("/orders")):o.isDismissed?(console.log("Navigating to products page..."),u.push("/products")):(console.log("Result undefined, going to orders as fallback"),u.push("/orders"))}).catch(o=>{console.error("SweetAlert error:",o),u.push("/orders")})},_=()=>{u.push("/products")},V=()=>{var n,e;console.log("Test navigation clicked"),console.log("Router available:",!!u),console.log("Current route:",(e=(n=u.currentRoute)==null?void 0:n.value)==null?void 0:e.path);try{console.log("Attempting to navigate to /orders..."),u.push("/orders")}catch(o){console.error("Router navigation error:",o),alert("Navigation error: "+o.message)}};return P(()=>{console.log("Checkout page loaded")}),(n,e)=>(i(),r("div",E,[e[34]||(e[34]=t("div",{class:"page-header px-4 py-6 md:px-6 md:py-8"},[t("div",{class:"max-w-7xl mx-auto"},[t("h1",{class:"text-2xl md:text-3xl font-bold"},"Checkout"),t("p",{class:"text-primary-100 mt-2 text-sm md:text-base"},"Complete your order details")])],-1)),t("div",K,[t("div",L,[t("div",A,[t("div",I,[e[15]||(e[15]=t("h2",{class:"text-lg md:text-xl font-semibold text-gray-900 mb-3 md:mb-4"},"Order Summary",-1)),t("div",Z,[(i(!0),r($,null,F(f.value,(o,v)=>(i(),r("div",{key:o.id,class:"flex flex-col sm:flex-row sm:items-center sm:space-x-4 p-3 md:p-4 bg-gray-50 rounded-lg"},[t("img",{src:o.image,alt:o.name,class:"w-12 h-12 sm:w-16 sm:h-16 object-cover rounded-lg mb-3 sm:mb-0"},null,8,z),t("div",G,[t("h3",H,l(o.name),1),t("p",J,l(o.farmer),1),t("p",Q,l(o.quantity)+" "+l(o.unit)+" Ã— TZS "+l(o.price.toLocaleString()),1)]),t("div",W,[t("p",Y,"TZS "+l((o.price*o.quantity).toLocaleString()),1)])]))),128))])]),t("div",ee,[e[23]||(e[23]=t("h2",{class:"text-xl font-semibold text-gray-900 mb-4"},"Delivery Information",-1)),t("div",te,[t("div",null,[e[16]||(e[16]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Full Name *",-1)),d(t("input",{"onUpdate:modelValue":e[0]||(e[0]=o=>a.value.name=o),type:"text",class:c(["input-field",{"border-red-500":s.value.name}]),placeholder:"Enter your full name",onBlur:e[1]||(e[1]=o=>p("name"))},null,34),[[y,a.value.name]]),s.value.name?(i(),r("p",oe,l(s.value.name),1)):g("",!0)]),t("div",null,[e[17]||(e[17]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Email Address *",-1)),d(t("input",{"onUpdate:modelValue":e[2]||(e[2]=o=>a.value.email=o),type:"email",class:c(["input-field",{"border-red-500":s.value.email}]),placeholder:"your.email@example.com",onBlur:e[3]||(e[3]=o=>p("email"))},null,34),[[y,a.value.email]]),s.value.email?(i(),r("p",ae,l(s.value.email),1)):g("",!0)]),t("div",null,[e[18]||(e[18]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Phone Number *",-1)),d(t("input",{"onUpdate:modelValue":e[4]||(e[4]=o=>a.value.phone=o),type:"tel",class:c(["input-field",{"border-red-500":s.value.phone}]),placeholder:"+255 XXX XXX XXX",onBlur:e[5]||(e[5]=o=>p("phone"))},null,34),[[y,a.value.phone]]),s.value.phone?(i(),r("p",se,l(s.value.phone),1)):g("",!0)]),t("div",null,[e[20]||(e[20]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Region *",-1)),d(t("select",{"onUpdate:modelValue":e[6]||(e[6]=o=>a.value.region=o),class:c(["input-field",{"border-red-500":s.value.region}]),onChange:e[7]||(e[7]=o=>p("region"))},[...e[19]||(e[19]=[U('<option value="">Select Region</option><option value="arusha">Arusha</option><option value="dar-es-salaam">Dar es Salaam</option><option value="dodoma">Dodoma</option><option value="geita">Geita</option><option value="iringa">Iringa</option><option value="kagera">Kagera</option><option value="katavi">Katavi</option><option value="kilimanjaro">Kilimanjaro</option><option value="kigoma">Kigoma</option><option value="kilosa">Kilosa</option><option value="kinondoni">Kinondoni</option><option value="kiteto">Kiteto</option><option value="kondoa">Kondoa</option><option value="lindi">Lindi</option><option value="manyara">Manyara</option><option value="mara">Mara</option><option value="mbeya">Mbeya</option><option value="meatu">Meatu</option><option value="morogoro">Morogoro</option><option value="mwanga">Mwanga</option><option value="mwanza">Mwanza</option><option value="nachingwea">Nachingwea</option><option value="njombe">Njombe</option><option value="norte">Norte</option><option value="pemba">Pemba</option><option value="pwani">Pwani</option><option value="rukwa">Rukwa</option><option value="ruvuma">Ruvuma</option><option value="shinyanga">Shinyanga</option><option value="simiyu">Simiyu</option><option value="singida">Singida</option><option value="tabora">Tabora</option><option value="tanga">Tanga</option><option value="ukerewe">Ukerewe</option><option value="unguja">Unguja (Zanzibar)</option>',36)])],34),[[R,a.value.region]]),s.value.region?(i(),r("p",le,l(s.value.region),1)):g("",!0)]),t("div",null,[e[21]||(e[21]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"City/District *",-1)),d(t("input",{"onUpdate:modelValue":e[8]||(e[8]=o=>a.value.city=o),type:"text",class:c(["input-field",{"border-red-500":s.value.city}]),placeholder:"Enter city or district name",onBlur:e[9]||(e[9]=o=>p("city"))},null,34),[[y,a.value.city]]),s.value.city?(i(),r("p",ne,l(s.value.city),1)):g("",!0)]),t("div",ie,[e[22]||(e[22]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Delivery Address *",-1)),d(t("textarea",{"onUpdate:modelValue":e[10]||(e[10]=o=>a.value.address=o),class:c(["input-field",{"border-red-500":s.value.address}]),rows:"3",placeholder:"Enter your complete delivery address (street, building, landmarks)",onBlur:e[11]||(e[11]=o=>p("address"))},null,34),[[y,a.value.address]]),s.value.address?(i(),r("p",re,l(s.value.address),1)):g("",!0)])])]),t("div",de,[e[27]||(e[27]=t("h2",{class:"text-xl font-semibold text-gray-900 mb-4"},"Payment Method",-1)),t("div",ue,[t("label",me,[d(t("input",{"onUpdate:modelValue":e[12]||(e[12]=o=>m.value=o),type:"radio",value:"mobile-money",class:"text-primary-600"},null,512),[[S,m.value]]),e[24]||(e[24]=t("div",{class:"flex-1"},[t("p",{class:"font-medium text-gray-900"},"Mobile Money"),t("p",{class:"text-sm text-gray-600"},"Tigo Pesa, Airtel Money, Halopesa")],-1))]),t("label",pe,[d(t("input",{"onUpdate:modelValue":e[13]||(e[13]=o=>m.value=o),type:"radio",value:"cash-on-delivery",class:"text-primary-600"},null,512),[[S,m.value]]),e[25]||(e[25]=t("div",{class:"flex-1"},[t("p",{class:"font-medium text-gray-900"},"Cash on Delivery"),t("p",{class:"text-sm text-gray-600"},"Pay when you receive your order")],-1))]),t("label",ve,[d(t("input",{"onUpdate:modelValue":e[14]||(e[14]=o=>m.value=o),type:"radio",value:"bank-transfer",class:"text-primary-600"},null,512),[[S,m.value]]),e[26]||(e[26]=t("div",{class:"flex-1"},[t("p",{class:"font-medium text-gray-900"},"Bank Transfer"),t("p",{class:"text-sm text-gray-600"},"Direct bank transfer")],-1))])])])]),t("div",ce,[t("div",ge,[e[33]||(e[33]=t("h2",{class:"text-xl font-semibold text-gray-900 mb-4"},"Order Total",-1)),t("div",xe,[t("div",ye,[e[28]||(e[28]=t("span",{class:"text-gray-600"},"Subtotal",-1)),t("span",be,"TZS "+l(x.value.toLocaleString()),1)]),t("div",fe,[e[29]||(e[29]=t("span",{class:"text-gray-600"},"Delivery Fee",-1)),t("span",ke,"TZS "+l(h.value.toLocaleString()),1)]),t("div",he,[e[30]||(e[30]=t("span",{class:"text-gray-600"},"Service Fee",-1)),t("span",we,"TZS "+l(w.value.toLocaleString()),1)]),t("div",Se,[t("div",Ce,[e[31]||(e[31]=t("span",{class:"text-lg font-semibold text-gray-900"},"Total",-1)),t("span",Te,"TZS "+l(C.value.toLocaleString()),1)])])]),t("button",{onClick:X,class:"w-full btn-primary mt-6",disabled:!M.value}," Place Order ",8,Oe),t("button",{onClick:_,class:"w-full btn-secondary mt-3"}," Back to Shopping "),t("div",{class:"mt-4 p-3 bg-yellow-100 rounded"},[e[32]||(e[32]=t("p",{class:"text-sm text-gray-700 mb-2"},"Debug Test:",-1)),t("button",{onClick:V,class:"px-4 py-2 bg-yellow-500 text-white rounded text-sm"}," Test Navigation to Orders ")])])])])])]))}};export{Xe as default};
