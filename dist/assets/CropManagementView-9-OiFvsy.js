import{p as J,d as K,o as n,c as i,a as e,k as f,j as m,b as _,F as Y,r as A,t as a,s as r,v as p,B as y,l as q,f as x,g as F,q as M,z as W,h as d,G as X}from"./index-vxcYk4Au.js";import{u as Z}from"./crops-Wa7zaDxD.js";import{P as ee}from"./plus-HctYyu7r.js";import{S as te}from"./search-vThbN0CU.js";import{P as se}from"./pen-square-CDjbir98.js";import{T as le}from"./trash-2-ctTkwP4k.js";import{L as oe}from"./leaf-CVhIAYj5.js";const ae={class:"min-h-screen bg-earth-50"},ne={class:"page-header px-6 py-8"},ie={class:"max-w-7xl mx-auto flex justify-between items-center"},re={class:"max-w-7xl mx-auto px-6 py-8"},de={class:"card p-6 mb-6"},ue={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},pe={class:"font-medium text-gray-900"},me={class:"text-sm text-gray-600 mt-1"},ve={class:"text-xs text-primary-600 mt-2"},ce={class:"card p-6 mb-6"},ge={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},xe={class:"relative"},fe=["value"],ye={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},be={class:"p-6"},we={class:"flex justify-between items-start mb-4"},Ce={class:"text-lg font-semibold text-gray-900"},he={class:"text-sm text-gray-500"},ke={class:"flex space-x-1"},Se=["onClick"],He=["onClick"],De={class:"space-y-3"},Ve={class:"flex justify-between text-sm"},Ue={class:"font-medium"},Ye={class:"flex justify-between text-sm"},Ae={class:"font-medium"},Me={class:"flex justify-between text-sm"},Ne={class:"font-medium"},je={key:0,class:"flex justify-between text-sm"},_e={class:"font-medium text-green-600"},qe={class:"mt-4 flex items-center justify-between"},Fe={key:0,class:"mt-3 flex items-center text-green-600 text-sm"},Pe={class:"mt-4 space-y-2"},$e=["onClick"],Ee=["onClick"],Le=["onClick"],Re={key:0,class:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50"},Te={class:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-lg bg-white"},ze={class:"mt-3"},Be={class:"text-lg font-medium text-gray-900 mb-4"},Ge=["value"],Ie={class:"flex items-center"},Oe={class:"flex justify-end space-x-3 pt-4"},Qe={type:"submit",class:"btn-primary"},Je={key:1,class:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50"},Ke={class:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-lg bg-white"},We={class:"mt-3"},Xe={class:"flex justify-end space-x-3 pt-4"},Ze={key:2,class:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50"},et={class:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-lg bg-white"},tt={class:"mt-3"},st={class:"flex justify-end space-x-3 pt-4"},pt={__name:"CropManagementView",setup(lt){const b=J(),u=Z(),w=d(""),C=d(""),h=d(""),k=d(""),S=d(!1),H=d(!1),D=d(!1),v=d(null),V=d(null),o=d({name:"",category:"",plantingDate:"",expectedHarvest:"",expectedYield:"",location:"",climateSmart:!1}),c=d({health:"",notes:""}),g=d({actualYield:"",harvestDate:""}),P=X(()=>{let l=u.getCrops();return b.isFarmer&&(l=l.filter(t=>t.farmerId===b.user.id)),w.value&&(l=l.filter(t=>t.name.toLowerCase().includes(w.value.toLowerCase()))),C.value&&(l=l.filter(t=>t.category===C.value)),h.value&&(l=l.filter(t=>t.status===h.value)),k.value&&(l=l.filter(t=>t.health===k.value)),l}),$=l=>{const t=u.cropCategories.find(s=>s.id===l);return t?t.name:l},E=l=>{switch(l){case"planted":return"bg-yellow-100 text-yellow-800";case"growing":return"bg-green-100 text-green-800";case"harvested":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}},L=l=>{switch(l){case"excellent":return"bg-green-100 text-green-800";case"good":return"bg-blue-100 text-blue-800";case"fair":return"bg-yellow-100 text-yellow-800";case"poor":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},N=l=>new Date(l).toLocaleDateString(),R=l=>{v.value=l,o.value={...l},S.value=!0},T=()=>{console.log("saveCrop called",o.value),console.log("cropsStore:",u),console.log("authStore.user:",b.user);const l={...o.value,farmerId:b.user.id};v.value?(console.log("Updating crop"),u.updateCrop(v.value.id,l)):(console.log("Adding new crop"),u.addCrop(l)),j(),window.addNotification({type:"success",title:"Crop Saved",message:`Crop has been successfully ${v.value?"updated":"added"}.`})},z=l=>{confirm("Are you sure you want to delete this crop?")&&window.addNotification({type:"success",title:"Crop Deleted",message:"Crop has been removed from the system."})},B=l=>{V.value=l,c.value={health:l.health,notes:l.notes||""},H.value=!0},G=()=>{u.updateCropHealth(V.value.id,c.value.health,c.value.notes),H.value=!1,window.addNotification({type:"success",title:"Health Updated",message:"Crop health status has been updated."})},I=l=>{V.value=l,g.value={actualYield:"",harvestDate:new Date().toISOString().split("T")[0]},D.value=!0},O=()=>{u.harvestCrop(V.value.id,g.value.actualYield,g.value.harvestDate),D.value=!1,window.addNotification({type:"success",title:"Harvest Recorded",message:"Harvest has been recorded successfully."})},Q=l=>{console.log("View crop details:",l)},j=()=>{S.value=!1,v.value=null,o.value={name:"",category:"",plantingDate:"",expectedHarvest:"",expectedYield:"",location:"",climateSmart:!1}};return K(()=>{}),(l,t)=>(n(),i("div",ae,[e("div",ne,[e("div",ie,[t[19]||(t[19]=e("div",null,[e("h1",{class:"text-3xl font-bold"},"Crop Management"),e("p",{class:"text-primary-100 mt-2"},"Track and manage your crop production")],-1)),e("button",{onClick:t[0]||(t[0]=s=>S.value=!0),class:"btn-primary"},[f(m(ee),{class:"w-4 h-4 mr-2"}),t[18]||(t[18]=_(" Add Crop ",-1))])])]),e("div",re,[e("div",de,[t[20]||(t[20]=e("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"ðŸŒ Climate-Smart Recommendations",-1)),e("div",ue,[(n(!0),i(Y,null,A(m(u).climateSmartRecommendations,s=>(n(),i("div",{key:s.crop,class:"border rounded-lg p-4"},[e("h3",pe,a(s.crop),1),e("p",me,a(s.reason),1),e("p",ve,"Best for: "+a(s.regions.join(", ")),1)]))),128))])]),e("div",ce,[e("div",ge,[e("div",null,[t[21]||(t[21]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Search",-1)),e("div",xe,[f(m(te),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),r(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>w.value=s),type:"text",placeholder:"Search crops...",class:"input-field pl-10"},null,512),[[p,w.value]])])]),e("div",null,[t[23]||(t[23]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Category",-1)),r(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>C.value=s),class:"input-field"},[t[22]||(t[22]=e("option",{value:""},"All Categories",-1)),(n(!0),i(Y,null,A(m(u).cropCategories,s=>(n(),i("option",{key:s.id,value:s.id},a(s.icon)+" "+a(s.name),9,fe))),128))],512),[[y,C.value]])]),e("div",null,[t[25]||(t[25]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Status",-1)),r(e("select",{"onUpdate:modelValue":t[3]||(t[3]=s=>h.value=s),class:"input-field"},[...t[24]||(t[24]=[e("option",{value:""},"All Status",-1),e("option",{value:"planted"},"Planted",-1),e("option",{value:"growing"},"Growing",-1),e("option",{value:"harvested"},"Harvested",-1)])],512),[[y,h.value]])]),e("div",null,[t[27]||(t[27]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Health",-1)),r(e("select",{"onUpdate:modelValue":t[4]||(t[4]=s=>k.value=s),class:"input-field"},[...t[26]||(t[26]=[q('<option value="">All Health</option><option value="excellent">Excellent</option><option value="good">Good</option><option value="fair">Fair</option><option value="poor">Poor</option>',5)])],512),[[y,k.value]])])])]),e("div",ye,[(n(!0),i(Y,null,A(P.value,s=>(n(),i("div",{key:s.id,class:"card overflow-hidden hover:shadow-lg transition-shadow"},[e("div",be,[e("div",we,[e("div",null,[e("h3",Ce,a(s.name),1),e("span",he,a($(s.category)),1)]),e("div",ke,[e("button",{onClick:U=>R(s),class:"p-1 text-accent-600 hover:text-accent-800"},[f(m(se),{class:"w-4 h-4"})],8,Se),e("button",{onClick:U=>z(s.id),class:"p-1 text-red-600 hover:text-red-800"},[f(m(le),{class:"w-4 h-4"})],8,He)])]),e("div",De,[e("div",Ve,[t[28]||(t[28]=e("span",{class:"text-gray-600"},"Planted:",-1)),e("span",Ue,a(N(s.plantingDate)),1)]),e("div",Ye,[t[29]||(t[29]=e("span",{class:"text-gray-600"},"Expected Harvest:",-1)),e("span",Ae,a(N(s.expectedHarvest)),1)]),e("div",Me,[t[30]||(t[30]=e("span",{class:"text-gray-600"},"Expected Yield:",-1)),e("span",Ne,a(s.expectedYield)+" kg",1)]),s.actualYield?(n(),i("div",je,[t[31]||(t[31]=e("span",{class:"text-gray-600"},"Actual Yield:",-1)),e("span",_e,a(s.actualYield)+" kg",1)])):x("",!0)]),e("div",qe,[e("span",{class:F(["px-2 py-1 text-xs font-semibold rounded-full",E(s.status)])},a(s.status),3),e("span",{class:F(["px-2 py-1 text-xs font-semibold rounded-full",L(s.health)])},a(s.health),3)]),s.climateSmart?(n(),i("div",Fe,[f(m(oe),{class:"w-4 h-4 mr-1"}),t[32]||(t[32]=_(" Climate Smart ",-1))])):x("",!0),e("div",Pe,[s.status==="growing"?(n(),i("button",{key:0,onClick:U=>B(s),class:"w-full btn-secondary text-sm py-2"}," Update Health ",8,$e)):x("",!0),s.status==="growing"?(n(),i("button",{key:1,onClick:U=>I(s),class:"w-full btn-primary text-sm py-2"}," Record Harvest ",8,Ee)):x("",!0),e("button",{onClick:U=>Q(s),class:"w-full text-sm text-primary-600 hover:text-primary-800 py-2"}," View Details ",8,Le)])])]))),128))]),S.value?(n(),i("div",Re,[e("div",Te,[e("div",ze,[e("h3",Be,a(v.value?"Edit Crop":"Add New Crop"),1),e("form",{onSubmit:M(T,["prevent"]),class:"space-y-4"},[e("div",null,[t[33]||(t[33]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Crop Name",-1)),r(e("input",{"onUpdate:modelValue":t[5]||(t[5]=s=>o.value.name=s),type:"text",required:"",class:"input-field"},null,512),[[p,o.value.name]])]),e("div",null,[t[35]||(t[35]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Category",-1)),r(e("select",{"onUpdate:modelValue":t[6]||(t[6]=s=>o.value.category=s),required:"",class:"input-field"},[t[34]||(t[34]=e("option",{value:""},"Select category",-1)),(n(!0),i(Y,null,A(m(u).cropCategories,s=>(n(),i("option",{key:s.id,value:s.id},a(s.icon)+" "+a(s.name),9,Ge))),128))],512),[[y,o.value.category]])]),e("div",null,[t[36]||(t[36]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Planting Date",-1)),r(e("input",{"onUpdate:modelValue":t[7]||(t[7]=s=>o.value.plantingDate=s),type:"date",required:"",class:"input-field"},null,512),[[p,o.value.plantingDate]])]),e("div",null,[t[37]||(t[37]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Expected Harvest Date",-1)),r(e("input",{"onUpdate:modelValue":t[8]||(t[8]=s=>o.value.expectedHarvest=s),type:"date",required:"",class:"input-field"},null,512),[[p,o.value.expectedHarvest]])]),e("div",null,[t[38]||(t[38]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Expected Yield (kg)",-1)),r(e("input",{"onUpdate:modelValue":t[9]||(t[9]=s=>o.value.expectedYield=s),type:"number",required:"",class:"input-field"},null,512),[[p,o.value.expectedYield]])]),e("div",null,[t[39]||(t[39]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Location",-1)),r(e("input",{"onUpdate:modelValue":t[10]||(t[10]=s=>o.value.location=s),type:"text",required:"",class:"input-field"},null,512),[[p,o.value.location]])]),e("div",Ie,[r(e("input",{"onUpdate:modelValue":t[11]||(t[11]=s=>o.value.climateSmart=s),type:"checkbox",class:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"},null,512),[[W,o.value.climateSmart]]),t[40]||(t[40]=e("label",{class:"ml-2 block text-sm text-gray-700"}," Climate Smart Crop ",-1))]),e("div",Oe,[e("button",{type:"button",onClick:j,class:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200"}," Cancel "),e("button",Qe,a(v.value?"Update":"Add")+" Crop ",1)])],32)])])])):x("",!0),H.value?(n(),i("div",Je,[e("div",Ke,[e("div",We,[t[45]||(t[45]=e("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Update Crop Health",-1)),e("form",{onSubmit:M(G,["prevent"]),class:"space-y-4"},[e("div",null,[t[42]||(t[42]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Health Status",-1)),r(e("select",{"onUpdate:modelValue":t[12]||(t[12]=s=>c.value.health=s),required:"",class:"input-field"},[...t[41]||(t[41]=[q('<option value="">Select health status</option><option value="excellent">Excellent</option><option value="good">Good</option><option value="fair">Fair</option><option value="poor">Poor</option>',5)])],512),[[y,c.value.health]])]),e("div",null,[t[43]||(t[43]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Notes",-1)),r(e("textarea",{"onUpdate:modelValue":t[13]||(t[13]=s=>c.value.notes=s),rows:"3",class:"input-field",placeholder:"Add any observations or notes..."},null,512),[[p,c.value.notes]])]),e("div",Xe,[e("button",{type:"button",onClick:t[14]||(t[14]=s=>H.value=!1),class:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200"}," Cancel "),t[44]||(t[44]=e("button",{type:"submit",class:"btn-primary"},"Update Health",-1))])],32)])])])):x("",!0),D.value?(n(),i("div",Ze,[e("div",et,[e("div",tt,[t[49]||(t[49]=e("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Record Harvest",-1)),e("form",{onSubmit:M(O,["prevent"]),class:"space-y-4"},[e("div",null,[t[46]||(t[46]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Actual Yield (kg)",-1)),r(e("input",{"onUpdate:modelValue":t[15]||(t[15]=s=>g.value.actualYield=s),type:"number",required:"",class:"input-field"},null,512),[[p,g.value.actualYield]])]),e("div",null,[t[47]||(t[47]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Harvest Date",-1)),r(e("input",{"onUpdate:modelValue":t[16]||(t[16]=s=>g.value.harvestDate=s),type:"date",required:"",class:"input-field"},null,512),[[p,g.value.harvestDate]])]),e("div",st,[e("button",{type:"button",onClick:t[17]||(t[17]=s=>D.value=!1),class:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200"}," Cancel "),t[48]||(t[48]=e("button",{type:"submit",class:"btn-primary"},"Record Harvest",-1))])],32)])])])):x("",!0)])]))}};export{pt as default};
